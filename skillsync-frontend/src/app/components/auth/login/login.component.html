<div class="login-container">
  <h2>{{ 'AUTH.LOGIN.TITLE' | translate }}</h2>
  <form [formGroup]="loginForm" (ngSubmit)="login()">
    <mat-form-field appearance="fill">
      <mat-label>{{ 'AUTH.LOGIN.USERNAME' | translate }}</mat-label>
      <input matInput formControlName="username" required>
      <mat-error *ngIf="loginForm.get('username')?.hasError('required')">
        {{ 'ERRORS.REQUIRED' | translate }}
      </mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>{{ 'AUTH.LOGIN.PASSWORD' | translate }}</mat-label>
      <input matInput type="password" formControlName="password" required>
      <mat-error *ngIf="loginForm.get('password')?.hasError('required')">
        {{ 'ERRORS.REQUIRED' | translate }}
      </mat-error>
    </mat-form-field>

    <button mat-raised-button color="primary" type="submit" [disabled]="loginForm.invalid || isLoading">
      <mat-spinner diameter="20" *ngIf="isLoading"></mat-spinner>
      <span *ngIf="!isLoading">{{ 'AUTH.LOGIN.SUBMIT' | translate }}</span>
    </button>
  </form>

  <p>
    <a routerLink="/forgot-password">{{ 'AUTH.LOGIN.FORGOT_PASSWORD' | translate }}</a>
  </p>
  <p>
    {{ 'AUTH.LOGIN.NO_ACCOUNT' | translate }}
    <a routerLink="/register">{{ 'AUTH.LOGIN.SIGN_UP' | translate }}</a>
  </p>
</div>

<div *ngIf="showTwoFactorForm" aria-live="polite">
  <form [formGroup]="twoFactorForm" (ngSubmit)="verifyTwoFactor()">
    <mat-form-field appearance="fill">
      <mat-label for="twoFactorCode">{{ 'LOGIN.VERIFICATION_CODE' | translate }}</mat-label>
      <input matInput id="twoFactorCode" formControlName="code" required autocomplete="one-time-code">
      <mat-error *ngIf="twoFactorForm.get('code')?.hasError('required')">{{ 'LOGIN.VERIFICATION_CODE_REQUIRED' | translate }}</mat-error>
      <mat-error *ngIf="twoFactorForm.get('code')?.hasError('minlength') || twoFactorForm.get('code')?.hasError('maxlength')">
        {{ 'LOGIN.VERIFICATION_CODE_LENGTH' | translate }}
      </mat-error>
    </mat-form-field>

    <button mat-raised-button color="primary" type="submit" [disabled]="twoFactorForm.invalid || isLoading">
      <mat-spinner *ngIf="isLoading" diameter="20"></mat-spinner>
      <span *ngIf="!isLoading">{{ 'LOGIN.VERIFY' | translate }}</span>
    </button>
  </form>
</div>

<div class="social-login">
  <button mat-raised-button color="primary" (click)="googleLogin()">
    <mat-icon svgIcon="google-logo"></mat-icon>
    {{ 'LOGIN.GOOGLE_SIGN_IN' | translate }}
  </button>
  <button mat-raised-button color="primary" (click)="facebookLogin()">
    <mat-icon svgIcon="facebook-logo"></mat-icon>
    {{ 'LOGIN.FACEBOOK_SIGN_IN' | translate }}
  </button>
</div>
